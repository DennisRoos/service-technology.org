\documentclass[a4paper,11pt]{article}

% Letzte Änderungen von: $Author: weinberg $ am $Date: 2008-03-31 08:37:38 $
% UEBERARBEITET VON JAN SUERMELI AM 29.02.2008

\usepackage{url}
\usepackage{amsmath}
\usepackage{bbm}
\usepackage[latin1]{inputenc}
\usepackage[ngerman,english]{babel}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage[outercaption]{sidecap}
\usepackage{xspace}
\usepackage{sectsty}
\usepackage{moreverb}
\usepackage{longtable}
\setlength{\parindent}{0pt}
%\usepackage[pdftex,bookmarks=true,bookmarksnumbered=true]{hyperref}
%\hypersetup{
%    pdfauthor = {Daniela Weinberg},
%    pdftitle = {Guide to Fiona},
%    pdfsubject = {Fiona - Functional Interaction Analysis for Open Workflow Nets},
%    pdfkeywords = {},
%    pdfcreator = {LaTeX with hyperref package},
%    pdfproducer = {dvips + ps2pdf}
%}
%\journal{DKE}

%\setlength{\intextsep}{2mm}%{6mm plus 2mm minus 2mm}

\newcommand{\abb}[1]{{\small\textsf{#1}}\xspace}

% NEED TO BE CHANGED!!!!
\newcommand{\VERSION}{1.0}
\newcommand{\LASTUPDATE}{\today}

\sectionfont{\sf}
\subsectionfont{\sf}
\subsubsectionfont{\sf}

%\newcommand{\abb}[1]{\textsf{#1}}

\begin{document}
%
\title{Fiona -- Functional Interaction Analysis for Open Workflow Nets}
%\subtitle{User's Manual}

\author{Peter Massuthe\\\url{massuthe@informatik.hu-berlin.de} \and Daniela
Weinberg\\\url{weinberg@informatik.hu-berlin.de}
\rm\\\\Humboldt-Universität zu Berlin, Institut für Informatik,\\
Unter den Linden 6, 10099 Berlin, Germany\\\url{http://www.informatik.hu-berlin.de/top/tools4bpel/fiona}}

\date{\today}

\maketitle
\begin{abstract}
This manual is for \textsc{Fiona}, Version \VERSION. \textsc{Fiona} is a tool to automatically
analyze the interactional behavior of open workflow nets (\textit{oWFN}). This manual does not
explain how to setup or install \textsc{Fiona}. For this information please read the Installation
Manual which is part of the distribution or can be downloaded from the \textsc{Fiona} website. Last
update: \LASTUPDATE.
\end{abstract}
\begin{quote}
\sf
\scriptsize
\copyright 2007 Daniela Weinberg. Copying and distribution of this file, with or without modification,
are permitted in any medium without royalty provided the copyright notice and this
notice are preserved.
\\
\selectlanguage{ngerman}
\\\copyright 2005, 2006, 2007 Daniela Weinberg, Peter
Massuthe, Karsten Wolf, Kathrin Kaschner, Christian Gierds and Jan Bretschneider, Martin
Znamirowski. \selectlanguage{english}\textsc{Fiona} is licensed under the \textit{GNU} General
Public License.
\\\\\textsc{Fiona} is
part of the Tools4\textit{BPEL} project funded by the Bundesministerium für Bildung und Forschung. See \url{http://www.informatik.hu-berlin.de/top/tools4bpel} for details.
\end{quote}

\rm
\normalsize
\newpage
\tableofcontents
\newpage

\section{Overview}\label{sec:Overview}
\subsection{Introduction}\label{subsec:Introduction}

\textsc{Fiona} is a tool to automatically analyze the interactional behavior of open workflow nets
(\textit{oWFN}) \cite{massuthe05_AMCT}. It provides the following techniques:

\begin{itemize}
\item It checks for the controllability of the given net by
computing the interaction graph \cite{weinberg2004-DA}.
\item It calculates the operating guideline \cite{massuthe05_AMCT} for the
net.
\item It matches an open workflow net (\textit{oWFN}) with an already existing
operating guideline \cite{massuthe05_AMCT}.
\item It can do various calculations on operating guidelines, including checks for equality and
equivalence, computing the product of two operating guidelines, computing the number of
characterized services, simulating and filtering.
\end{itemize}

Fiona uses operating guidelines and oWFNs as its input. oWFNs are the output of the tool
\textit{BPEL2oWFN}. Thus, any \textit{BPEL} (\textit{Business Process Execution Language for Web
Services}) process can easily be analyzed.

To compute the states of the graph nodes \textsc{Fiona} uses the efficient algorithms that were
implemented in the model checking tool \textit{LoLA}.

\textsc{Fiona} was developed by \selectlanguage{ngerman}Daniela Weinberg, Peter Massuthe, Karsten
Wolf, Kathrin Kaschner, Christian Gierds, Jan Bretschneider and Martin Znamirowski.
\selectlanguage{english} It is part of the Tools4\textit{BPEL} project funded by the German
Bundesministerium für Bildung und Forschung.

See \url{http://www.informatik.hu-berlin.de/top/tools4bpel} for details.

\newpage
\section{Installation}\label{sec:Installation}
There are two possibilities to get \textsc{Fiona} running. Either by using the precompiled binaries
that are provided for a variety of operating systems or by compiling the source code yourself.
Both, the binaries and the source code can be found in the download section of the website:
\begin{quote}
\url{http://www2.informatik.hu-berlin.de/top/tools4bpel/fiona/download.html}
\end{quote}

\subsection{Using the binaries}\label{subsec:UsingTheBinaries}

Even when using the binaries, \textsc{Fiona} will not be completely functional unless
\textit{GraphViz dot} is installed. In order to create graphical output \textsc{Fiona} uses system
calls to \textit{dot}. So \textit{dot} has to be callable from within the directory \textsc{Fiona}
is called. Otherwise no graphical output will be created. Not having \textit{dot} installed should
not interfere with the execution of \textsc{Fiona} in any other way than lacking graphical output.

\subsection{Using the source code}\label{subsec:UsingTheSourceCode}

Extract the compressed archive \texttt{fiona-2.0.tar.gz} into one directory. Make sure that the
archived folder structure is maintained. Before \textsc{Fiona} can be compiled, a number of tools
have to be available at the shell. For a detailed list of those tools please refer to the
installation guide given in the \texttt{/doc}-directory. Provided that all necessary tools are
available you can compile \textsc{Fiona} by typing the following commands in the \texttt{fiona}
directory:
\begin{quote}
\begin{verbatim}
$fiona/
automake -i ./configure make
\end{verbatim}
\end{quote}
To check if the compilation was succesful you can type \texttt{make check}. In general, the check
should pass all tests. In section \ref{sec:LimitationsAndBugs} on page
\pageref{sec:LimitationsAndBugs} we give a list of those tests that may not be successful in the
current distribution.

\newpage
\section{Invoking \textsc{Fiona}}\label{sec:InvokingFiona}

\textsc{Fiona}'s primary uses are deciding controllability of and building operating guidelines for
services given as \textit{oWFN}s. Therefore the standard invocations of \textsc{Fiona} are:

\begin{itemize}
\item checking controllability: \texttt{fiona -t ig inputNet.owfn}
\item calculating the operating guideline: \texttt{fiona -t og inputNet.owfn}
\end{itemize}

where \texttt{inputNet.owfn} contains an \textit{oWFN} written in the appropriate format (see
\ref{sec:InputFormats} on page \pageref{sec:InputFormats}). The option \texttt{-t ig} lets
\textsc{Fiona} generate the interaction graph of the given net. In case the graph's size is not too
big, a \texttt{png} graphic file is created that shows the interaction graph. Furthermore an output
is written on the command line indicating the size of the graph and the statement whether the oWFN
is controllable or not.

The option \texttt{-t og} lets \textsc{Fiona} generate the operating guideline of the given
\textit{oWFN}. In case the graph's size is not too big, a \texttt{png} graphic file is created that
shows the operating guideline. Furthermore an output is written on the command line indicating
various statistics of the operating guideline.

Since the start of the \textsc{Fiona} development process a lot of additional operations that
primarily deal with operating guidelines have been included. A short description of those functions
is given in this section, for more details on operating guidelines see section \ref{sec:OG} on page
\pageref{sec:OG}.

For more examples, see subsection \ref{subsec:Examples} on page \pageref{subsec:Examples}.

\textsc{Fiona} can be called without any parameter. In this case, it calculates the interaction
graph of the \textit{oWFN}, that is being read from the standard input (\texttt{stdin}).

The invocationscheme is as follows:
\begin{quote}
\texttt{fiona [OPTION]* [FILES]*}
\end{quote}

Note: Every file read will be automatically recognized as an oWFN or operating guideline by its
content or throw an error. Fiona supports reading multiple files by the '*' operator, for example:
\begin{quote}
\begin{verbatim}
fiona -t og *.owfn
\end{verbatim}
\end{quote}

\subsection{Options}\label{subsec:Options}

\textsc{Fiona} supports the following command-line options:

\paragraph{Help Function}

Print an overview of the command-line options and exit.

Command: \texttt{--help} or \texttt{-h}


\paragraph{Version Information}
Print the complete version information.

Command: \texttt{--version} or \texttt{-v}


\paragraph{Debugging}
Set the debuglevel to a value between 1 and 5.

Command: \texttt{--debug = <level>} or \texttt{-d <level>}

Parameters:
\begin{quote}
\sf
\begin{tabular}{rl}
\hline
\texttt{1 }& show nodes and dfs information\\
\hline
\texttt{2 }& show analysis information (i.e. colors)\\
\hline
\texttt{3 }& show information on events and states\\
\hline
\texttt{4 }& show more detailed information\\
\hline
\texttt{5 }& show detailed information on literally everything\\
\hline
\rm
\end{tabular}
\end{quote}

\paragraph{Modus Operandi}
Selects the \texttt{<type>} of action you want \textsc{Fiona} to process
\begin{quote}
Command: \texttt{--type=<type>} or \texttt{-t <type>}

Parameters:


\input{parts/modusoperandi.tex}

\end{quote}

\paragraph{Set message maximum}
Set the maximum number of same messages per state to \texttt{<level>}.

Command: \texttt{--messagemaximum = <level>} or \texttt{-m <level>}

\paragraph{Reduce IG}
Generate a reduced IG by applying reduction rules while the graph is calculated.

Command: \texttt{--reduceIG} or \texttt{-r}

\paragraph{Reduce Node states}
This reduction technique stores less states in each node of the IG/OG and during the calculation of
the graphs. So, in general it reduces memory. However, it might increase the computation time.

Command: \texttt{--reduce-nodes} or \texttt{-R}

\paragraph{Show additional information}
There are different display options for the graphics of operating guidelines and interaction
graphs.
\begin{quote}
Command: \texttt{--show = <parameter>} or \texttt{-s <parameter>}

Parameters:

\begin{longtable}{ll}
\hline
\texttt{allnodes }& show all nodes of the graph\\
\hline
\texttt{blue }& show blue nodes only (default)\\
\hline
\texttt{rednodes }& show blue and red nodes (no empty node and no black nodes)\\
\hline
\texttt{empty }& show empty node\\
\hline
\texttt{allstates }& show all calculated states per node\\
\hline
\texttt{deadlocks }& show all but transient states\\
\hline
\end{longtable}
\end{quote}

\paragraph{ BDD Construction}
The operating guidelines can represented as BDDs. Here, the BDD is created after the operating
guideline has been calculated. The argument \texttt{<reordering>} specifies the type of reodering
that is used.

\begin{quote}
Command: \texttt{--BDD = <reordering>} or \texttt{-b <reordering>}
\sf
Parameters:
\begin{longtable}{ll}
\hline
\texttt{0} & CUDD\_REORDER\_SAME \\
\hline
\texttt{1} & CUDD\_REORDER\_NONE\\
\hline
\texttt{2} & CUDD\_REORDER\_RANDOM\\
\hline
\texttt{3} & CUDD\_REORDER\_RANDOM\_PIVOT\\
\hline
\texttt{4} & CUDD\_REORDER\_SIFT\\
\hline
\texttt{5} & CUDD\_REORDER\_SIFT\_CONVERGE\\
\hline
\texttt{6} & CUDD\_REORDER\_SYMM\_SIFT\\
\hline
\texttt{7} & CUDD\_REORDER\_SYMM\_SIFT\_CONV\\
\hline
\texttt{8} & CUDD\_REORDER\_WINDOW2\\
\hline
\texttt{9} & CUDD\_REORDER\_WINDOW3\\
\hline
\texttt{10} & CUDD\_REORDER\_WINDOW4\\
\hline
\texttt{11}& CUDD\_REORDER\_WINDOW2\_CONV\\
\hline
\texttt{12}& CUDD\_REORDER\_WINDOW3\_CONV\\
\hline
\texttt{13}& CUDD\_REORDER\_WINDOW4\_CONV\\
\hline
\texttt{14}& CUDD\_REORDER\_GROUP\_SIFT\\
\hline
\texttt{15}& CUDD\_REORDER\_GROUP\_SIFT\_CONV\\
\hline
\texttt{16}& CUDD\_REORDER\_ANNEALING\\
\hline
\texttt{17}& CUDD\_REORDER\_GENETIC\\
\hline
\texttt{18}& CUDD\_REORDER\_LINEAR\\
\hline
\texttt{19}& CUDD\_REORDER\_LINEAR\_CONVERGE\\
\hline
\texttt{20}& CUDD\_REORDER\_LAZY\_SIFT\\
\hline
\texttt{21}& CUDD\_REORDER\_EXACT\\
\hline
\rm
\end{longtable}
\end{quote}


\paragraph{On the Fly BDD Construction}
The operating guidelines can also be calculated as BDDs on the fly.

Command: \texttt{--OnTheFly = <reordering>} or \texttt{-B <reordering>}

Parameters: See \textit{BDD Construction} for possible parameters.

\paragraph{Output prefix}
Sets a prefix string to all output files.

Command: \texttt{--output = <filename prefix>} or \texttt{-o <filename prefix>}

\paragraph{No output}
No output will be generated at all.

Command: \texttt{--no-output } or \texttt{-Q}

\paragraph{Additional parameters}
Further modification of the execution.

Command: \texttt{--parameter = <parameter> } or \texttt{-p <parameter>}

Parameters:

\begin{quote}
\begin{tabular}{ll}
\hline
\texttt{no-png} & does not create a PNG file \\
\hline
\end{tabular}
\end{quote}


\subsection{Examples Invocations}\label{subsec:Examples}
This section features some example invocations of \textsc{Fiona}.

\begin{itemize}

\item Generate an OG reordered by CUDD\_REORDER\_SAME and store the OG in a file named
\texttt{[oldfilename].og} for every oWFN in the current folder. No graphical output is generated.
\begin{quote}
\begin{verbatim}
fiona -t og -b 0 -p no-png *.owfn
\end{verbatim}
\end{quote}

\item Generate a \textit{GraphViz dot} graph of each oWFN in the same folder.
\begin{quote}
\begin{verbatim}
fiona -t png *.owfn
\end{verbatim}
\end{quote}

\item Generate an operating guideline product from all operating guidelines in the same folder.
\begin{quote}
\begin{verbatim}
fiona -t productog *.og
\end{verbatim}
\end{quote}


\item Check if the oWFN toBeMatched.owfn matches with the toMatch.og operating guideline with all
debug information being shown in the process.
\begin{quote}
\begin{verbatim}
fiona -t match -d 5 toMatch.og toBeMatched.owfn
\end{verbatim}
\end{quote}


\end{itemize}

\newpage
\section{Input Formats}\label{sec:InputFormats}

\textsc{Fiona} can have \textit{oWFN}s and \textit{operating guidelines} as its input. The
following subsections describe the corresponding file formats.

\subsection{\textit{oWFN} File Format}\label{subsec:oWFNFileFormat}

An open workflow net is a Petri net with an \textit{interface}, i.e. two additional sets of places:
\textit{input places} and \textit{output places}. Additionally an open workflow net has a set of
final markings. To represent \textit{oWFN}s the \textit{LoLA}-format was extended to implement this
class of Petri nets. The following code shows an example of a valid \textit(oWFN) file.
\begin{quote}
\begin{verbatim}
{ sample oWFN }

PLACES
  INTERNAL
    p1,
    p2;
  INPUT
    a;
  OUTPUT
    x,
    y,
    z;

INITIALMARKING
  p1:  2;

FINALCONDITION
  p2 = 4 AND ALL_OTHER_PLACES_EMPTY;

TRANSITION t1
CONSUME
  p1,
  a;
PRODUCE
  p2:2,
  x,
  y,
  z;
\end{verbatim}
\end{quote}

\subsubsection{Structure of the \textit{oWFN} file format}\label{subsubsec:oWFNFileFormat}
The structure of a net is determined by its places, transitions and the edges in between them. In
the oWFN-Format edges are not defined seperately. They are part of the transition definitions at
the end of the file. An oWFN file consists of 4 sections:

\begin{enumerate}
\item place definitions (see~\ref{subsubsec:places})
\item initial marking (see~\ref{subsubsec:initialMarking})
\item final markings (see~\ref{subsubsec:finalMarkings})
\item transition definitions (see~\ref{subsubsec:transitions})
\end{enumerate}

Comments in the oWFN code can be written in between \texttt{\{} and \texttt{\}}.

\subsubsection{Places}\label{subsubsec:places}

In the \texttt{PLACES} section the places of the net are specified. Here we distinguish between
\texttt{INTERNAL}, \texttt{INPUT} and \texttt{OUTPUT} places. A \texttt{PLACES} section of a net
looks like this:
\begin{quote}
\begin{verbatim}
PLACES
  INTERNAL
    p1,
    p2;
  INPUT
    a;
  OUTPUT
    x,
    y,
    z;
\end{verbatim}
\end{quote}

In this example we have two internal, one input and three output places. The names of the places
must be disjoint over all three categories, thus a place cannot be an input and an output place
at the same time.

The \texttt{PLACES} section is followed by the \texttt{INITIALMARKING} and \texttt{FINALMARKING} or
\texttt{FINALCONDITION} sections, which are explained later on.

\subsubsection{Initial Marking}\label{subsubsec:initialMarking}
The \texttt{PLACES} section is followed by the \texttt{INITIALMARKING} section. Every place which
is not listed in the \texttt{INITIALMARKING} section is implicitly assumed to have zero tokens
initially. If you want to create an initial state in which some places are marked, you have to list
exactly those places in the \texttt{INITIALMARKING} section. Make sure that you specify the correct
number of tokens of each place. The \texttt{INITIALMARKING} section can look as follows:
\begin{quote}
\begin{verbatim}
INITIALMARKING
  p1:  2,
  p2;
\end{verbatim}
\end{quote}

This definition specifies that the place \texttt{p1} contains two tokens and the place \texttt{p2}
contains one token initially. You can mark more than one place, by seperating the places by commata
and finishing the section with a semicolon. If a place is listed without a colon and the
corresponding number of tokens, the \textit{oWFN} file format implies the place is marked with one
token.

\subsubsection{Final Markings}\label{subsubsec:finalMarkings}

A final marking is defined either as a \texttt{FINALMARKING} or a \texttt{FINALCONDITION}. The main
difference is that a \texttt{FINALMARKING} can only describe one final state whereas the
\texttt{FINALCONDITION} can describe multiple final states.
\paragraph{Final Marking}

The \texttt{FINALMARKING} section has the same syntax as the \texttt{INITIALMARKING} section. Thus
one can list a number of places with a corresponding number of tokens. The final state described by
a \texttt{FINALMARKING} is meant to be a state in which the marking exactly matches the described
one, including not mentioned places as having zero tokens. This means, that a \texttt{FINALMARKING}
can only describe exactly one final state. A final marking looks like this:
\begin{quote}
\begin{verbatim}
FINALMARKING
  p2:  4;
\end{verbatim}
\end{quote}
This describes a final state in which the place \texttt{p2} has exactly four tokens and all other
places are empty.

\paragraph{Final Condition}
The syntax of a \tt FINALCONDITION \rm is different from that of a \tt
FINALMARKING \rm. If one wants to express that the place \texttt{p2} has to contain four tokens, the \texttt{FINALCONDITION} would look like
this:
\begin{quote}
\begin{verbatim}
FINALCONDITION
  p2 = 4;
\end{verbatim}
\end{quote}

This \texttt{FINALCONDITION} describes any state in which there are exactly four tokens on the
place \texttt{p2}. One could have instead used a different relation than equality. The \textit{oWFN} file
format supports equal, not equal, lesser, greater, less or equal and greater or equal. The two
examples are semantically different. While the examplary \texttt{FINALCONDITION} accepts any state
with four tokens on \texttt{p2} as a final state the examplary \texttt{FINALMARKING} only accepts one final
state, and that is where \texttt{p2} has four tokens and all other places have zero tokens. If one wants to
create a \texttt{FINALCONDITION} equal to the exemplary \texttt{FINALMARKING}, one can use the
boolean keywords \texttt{AND}, \texttt{OR} and \texttt{NOT}. The equal definition would then look
as follows:
\begin{quote}
\begin{verbatim}
FINALCONDITION
  p2 = 4 AND p1 = 0 AND a = 0 AND
  x = 0 AND y =0 AND z = 0;
\end{verbatim}
\end{quote}

All markings that fullfill the boolean formula are considered a final state of the oWFN. In this
case it is  exactly the same finalstate, as defined by the \texttt{FINALMARKING} with \texttt{p2}
containing four tokens and all other places zero. It can quickly become a nuisance to write or read
such a formula, especially if the \textit{oWFN}s become big. That is why there are a few keywords
to express different kind of empty places.

\begin{itemize}
\item \texttt{ALL\_OTHER\_INTERNAL\_PLACES\_EMPTY} requires only the internal places of the oWFN to be
empty.
\begin{quote}
\begin{verbatim}
FINALCONDITION
  p1 = 1 AND ALL_INTERNAL_PLACES_EMPTY;
\end{verbatim}
\end{quote}
\item \texttt{ALL\_OTHER\_EXTERNAL\_PLACES\_EMPTY} requires only the external places
(non-internal or interface places) of the oWFN to be empty.
\begin{quote}
\begin{verbatim}
FINALCONDITION
  p2 = 4 AND ALL_EXTERNAL_PLACES_EMPTY;
\end{verbatim}
\end{quote}
\item \texttt{ALL\_OTHER\_PLACES\_EMPTY} requires all places (regardless of their type) of the oWFN
that are not explicitly mentioned in the \texttt{FINALCONDITION} to be empty.
\begin{quote}
\begin{verbatim}
FINALCONDITION
  p2 = 4 AND ALL_OTHER_PLACES_EMPTY;
\end{verbatim}
\end{quote}
\end{itemize}

All three keywords can be combined at will. Saying
\begin{quote}
\begin{verbatim}
FINALCONDITION
  p2 = 4 AND ALL_OTHER_INTERNAL_PLACES_EMPTY
         AND ALL_OTHER_EXTERNAL_PLACES_EMPTY;
\end{verbatim}
\end{quote}

is the same as
\begin{quote}
\begin{verbatim}
FINALCONDITION
  p2 = 4 AND ALL_OTHER_PLACES_EMPTY;
\end{verbatim}
\end{quote}

All three keywords can only be used on the right hand side of a conjunction. The left hand side has
to be another state predicate. The whole conjunction is then again a state predicate. The rule is:

\begin{quote}
\begin{verbatim}
statepredicate := statepredicate
                  AND ALL_OTHER_PLACES_EMPTY
\end{verbatim}
\end{quote}

The scope of \texttt{ALL\_OTHER\_PLACES\_EMPTY} is the state predicate on the left hand side of the
conjunction above. All places that are not mentioned in that predicate are then required to be
empty.

In order to decide the scope of \texttt{ALL\_OTHER\_PLACES\_EMPTY}, it is crucial to understand all
bracing and precedence rules of state predicate formulas and that one can construct the whole
formula (including the correct bracketing) in his mind!

Suppose a different oWFN with places \texttt{p1}, \texttt{p2}, \texttt{p3}, and \texttt{p4}. Then the formula:
\begin{quote}
\begin{verbatim}
FINALCONDITION
  p1 = 1 AND ALL_OTHER_PLACES_EMPTY OR
  p2 = 1 AND ALL_OTHER_PLACES_EMPTY;
\end{verbatim}
\end{quote}

expands to:
\begin{quote}

\begin{verbatim}
FINALCONDITION
  (p1 = 1 AND p2 = 0 AND p3 = 0 AND p4 = 0) OR
  (p2 = 1 AND p1 = 0 AND p3 = 0 AND p4 = 0);
\end{verbatim}
\end{quote}

because \texttt{AND} takes precedence over \texttt{OR}.

In the same oWFN the formula
\begin{quote}
\begin{verbatim}
FINALCONDITION
  p1 = 1 AND ALL_OTHER_PLACES_EMPTY AND p2 = 1;
\end{verbatim}
\end{quote}

expands to
\begin{quote}
\begin{verbatim}
FINALCONDITION
  p1 = 1 AND p2 = 0 AND p3 = 0 AND p4 = 0 AND p2 = 1;
\end{verbatim}
\end{quote}

because \texttt{AND} is left associative. So the fully braced form of the original
formula is:
\begin{quote}
\begin{verbatim}
FINALCONDITION
  (((p1 = 1) AND ALL_OTHER_PLACES_EMPTY) AND (p2 = 1));
\end{verbatim}
\end{quote}


Consequently \texttt{(p1 = 1)} is the scope of \texttt{ALL\_OTHER\_PLACES\_EMPTY}. Therefore
\texttt{ALL\_OTHER\_PLACES\_EMPTY} expands to \texttt{((p2 = 0) AND (p3 = 0) AND (p4 = 0))}.
Putting it all together and removing redundant braces results in
\begin{quote}
\begin{verbatim}
FINALCONDITION
  p1 = 1 AND p2 = 0 AND p3 = 0 AND p4 = 0 AND p2 = 1;
\end{verbatim}
\end{quote}

which is the formula that was stated as the expansion in the first place.

As one might have already noticed, this formula is unsatisfiable because it
requires \texttt{p2} to be empty and marked at the same time. Therefore it is
recommended to use \texttt{ALL\_OTHER\_PLACES\_EMPTY} only at the very end of an n-ary
conjunction (or anywhere along with proper explicit bracing).

The same rules, of course, apply to \texttt{ALL\_OTHER\_INTERNAL\_PLACES\_EMPTY} and
\texttt{ALL\_OTHER\_EXTERNAL\_PLACES\_EMPTY}.

\subsubsection{Transitions}\label{subsubsec:transitions}
After the first three sections the transitions of the net including their incoming and outgoing
edges are defined. The fourth section does not have a headline like the first three. Rather, there
is one for each transition. A transition definition looks like this:
\begin{quote}
\begin{verbatim}
TRANSITION t1 CONSUME
  p1,
  a;
PRODUCE
  p2:2,
  x,
  y,
  z;
\end{verbatim}
\end{quote}

This example defines a transition named \texttt{t1} with six edges. Two edges lead from the places
\texttt{p1} and \texttt{a} to the transition and four lead from the transition to the places
\texttt{p2}, \texttt{x}, \texttt{y} and \texttt{z}, with the edge to \texttt{p2} having a weight of
2. A single place can be present under both \texttt{CONSUME} and \texttt{PRODUCE} in the same
transition. Such a structure is called a loop. Any other transitions of the net would just be
listed with the same syntax, thus starting with the \texttt{TRANSITION} keyword, followed by the
name of the transition followed by the \texttt{CONSUME} and \texttt{PRODUCE} parts containing
places, that must have been defined in the \texttt{PLACES} section beforehand. \texttt{CONSUME} and
\texttt{PRODUCE} are allowed to be empty, thus representing a transition which is not connected to
the rest of the net at all.

\subsection{File Format OG}\label{subsec:FileFormatOG}

\textsc{Fiona} accepts the \textit{og} file format as its input. The \textit{og} file consists of 3
sections:

\begin{enumerate}
\item \texttt{NODES}
\item \texttt{INITIALNODE}
\item \texttt{TRANSITIONS}
\end{enumerate}


\subsubsection{Nodes}\label{subsubsection:nodesOG}
In the first section, all nodes of the graph are specified. Each definition contains the node's
name and the boolean annotation of the node. Additionally a color for the node can be provided,
which is either red or blue. Red nodes are those that are not part of the final operating
guideline, but rather left over from building the operating guideline and have not been deleted yet
for diagnosis reasons. Blue nodes are equal to colorless nodes and are part of the actual operating
guideline. The different nodes are divided by commata, a semicolon finishes the section. Every node
has the following syntax:
\begin{quote}
\begin{verbatim}
nodeName:nodeAnnotation[:nodeColor]
\end{verbatim}
\end{quote}

\subsubsection{Initial Node}\label{subsubsection:initialNodeOG}
In the second section, one of the nodes is determined as the \textit{root node} by its name, the
section is finished by a semicolon:
\begin{quote}
\begin{verbatim}
nodeName
\end{verbatim}
\end{quote}

\subsubsection{Transitions}\label{subsubsection:transitionsOG}
In the last section all edges of the graph are specified. The different edges are divided by
commata, a semicolon finishes the section. Every edge has the following syntax:

\begin{quote}
\begin{verbatim}
sourceNodeName -> targetNodeName:edgeAnnotation
\end{verbatim}
\end{quote}

\subsubsection{Example \textit{og} file}\label{subsubsection:exampleFileOG}
Here is an example of a valid \textit{og} file:
\begin{quote}
\begin{verbatim}
NODES
  0 : ((!a)) : blue,
  1 : ((true)) : blue,
  2 : ((final + ?y) * (!b + ?y)) : blue,
  3 : ((final)) : blue;

INITIALNODE
  0;

TRANSITIONS
  0 -> 1 : ?x,
  0 -> 2 : !a,
  2 -> 3 : ?y;
\end{verbatim}
\end{quote}

\newpage
\section{Checking Controllability}\label{sec:CheckingControllability}

\subsection{Interaction Graph}\label{subsec:IG}

\tt
\begin{itemize}
\item ig
\item smallpartner
\item diagnosis
\end{itemize}
\rm

The interaction graph shows the states of the service, treating all inner states with the same
further communication behaviour as equal. By analyzing the interaction graph controllability of the
service can be efficiently decided. For more information on interaction graphs see
\cite{weinberg2004-DA}.

\subsection{Operating Guidelines}\label{subsec:OG}

\tt
\begin{itemize}
\item og
\item mostpermissivepartner
\item distributed
\item productog
\end{itemize}
\rm

\tt
\begin{itemize}
\item match
\item productog
\item simulates
\item filter
\item isacyclic
\item count
\end{itemize}
\rm

The operating guideline of a service characterizes every possible behaviour of the service's
environment that leads to a correct execution of the service, thus its termination. Any behaviour
of an environment, that is a subgraph of the operating guideline, includes the root node and
fullfills every nodes boolean annotation is a strategy for this service. For more detailed
information on operating guidelines refer to \cite{massuthe05_AMCT}.

\newpage
\section{Operating Guidelines}\label{sec:OG}

\section{Matching}\label{sec:Matching}

\section{Partner Synthesis}\label{sec:PartnerSynthesis}

\section{Other Modes}\label{sec:OtherModes}

\newpage
\section{Limitations and Bugs}\label{sec:LimitationsAndBugs}

\subsection{Limitations}\label{subsec:Limitations}

The current version of \textsc{Fiona} has several limitations:

\paragraph{Number of Strategies} The number of strategies, which are determined by the given og
can only be calculated if the og is acyclic and deterministic. It will also hold with a
warning in case the calculation becomes to ressourceful. The complexity of the used algorithm
is not polynomial.

\paragraph{Sequences} oWFNs model asynchronous communication behaviour. Even if the net has already
sent a message - therefore put a token on an output place - there is no mechanism to stop
the net until the message is consumed. Thus a simple sequence of sent messages quickly results
in a large operating guideline, which models every order of the consumption of those sent messages.
Examples can be taken from the \texttt{/tests/sequence\_suite} directory

\subsection{Known Bugs}\label{subsec:KnownBugs}

In the current version of Fiona there are the following issues:

\begin{description}
\item currently there are no documented bugs
\end{description}


\subsection{Reporting Bugs}\label{subsec:ReportingBugs}

If you find a bug in \textsc{Fiona}, please first check that it is not a known bug listed in `Known
Bugs'. Otherwise please send us an electronic mail to \url{weinberg@informatik.hu-berlin.de}.
Include the version number which you can find by running \texttt{fiona --version}. Also include in
your message the input \texttt{oWFN} process and the output that the program produced. We will try
to answer your mail within a week.

If you have other questions, comments or suggestions about \textsc{Fiona}, contact us via
electronic mail to \url{weinberg@informatik.hu-berlin.de}.

\bibliography{bibs}
\bibliographystyle{alpha}

\end{document}
