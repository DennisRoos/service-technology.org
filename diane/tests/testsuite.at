AT_INIT

############################################################################
AT_BANNER([Standard Options])
############################################################################

AT_SETUP([Help output])
AT_CHECK([DIANE --help],0,ignore)
AT_KEYWORDS(basic)
AT_CLEANUP

AT_SETUP([Version output])
AT_CHECK([DIANE --version],0,ignore)
AT_KEYWORDS(basic)
AT_CLEANUP

AT_SETUP([Bug information output])
AT_CHECK([DIANE --bug],0,ignore,[Please send file 'bug.log' to diane@service-technology.org.
])
AT_CHECK([test -f bug.log])
AT_KEYWORDS(basic)
AT_CLEANUP


############################################################################
AT_BANNER([Errors])
############################################################################

AT_SETUP([Input file not found])
AT_CHECK([DIANE foo.lola],1,ignore,stderr)
AT_CHECK([GREP -q "aborting \[[#01\]]" stderr])
AT_KEYWORDS(error)
AT_CLEANUP

AT_SETUP([Input file not parsed])
AT_CHECK([cp TESTFILES/PO.owfn .])
AT_CHECK([DIANE PO.owfn],1,ignore,stderr)
AT_CHECK([GREP -q "aborting \[[#02\]]" stderr])
AT_KEYWORDS(error)
AT_CLEANUP

############################################################################
#AT_BANNER([Regression Tests])
############################################################################

############################################################################
AT_BANNER([Components])
############################################################################

AT_SETUP([Number of Components])
AT_CHECK([cp TESTFILES/phils.lola .])
AT_CHECK([DIANE phils.lola -q],0,stdout)
AT_CHECK([GREP -q "number of components: 20" stdout],0)
AT_KEYWORDS(components)
AT_CLEANUP

############################################################################
AT_BANNER([Service Flag])
############################################################################

AT_SETUP([Number of Service Components])
AT_CHECK([cp TESTFILES/phils.lola .])
AT_CHECK([DIANE phils.lola -q --service],0,stdout)
AT_CHECK([GREP -q "number of components: 1" stdout],0)
AT_KEYWORDS(service)
AT_CLEANUP
