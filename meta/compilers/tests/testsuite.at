AT_INIT

############################################################################
AT_BANNER([Standard Options])
############################################################################

AT_SETUP([Help output (fiona2wendy)])
AT_CHECK([FIONA2WENDY --help],0,ignore)
AT_KEYWORDS(basic)
AT_CLEANUP

AT_SETUP([Help output (wendy2fiona)])
AT_CHECK([WENDY2FIONA --help],0,ignore)
AT_KEYWORDS(basic)
AT_CLEANUP

AT_SETUP([Version output (fiona2wendy)])
AT_CHECK([FIONA2WENDY --version],0,ignore)
AT_KEYWORDS(basic)
AT_CLEANUP

AT_SETUP([Version output (wendy2fiona)])
AT_CHECK([WENDY2FIONA --version],0,ignore)
AT_KEYWORDS(basic)
AT_CLEANUP

############################################################################
AT_BANNER([Fiona <-> Wendy])
############################################################################

AT_SETUP([Syntax Example 1])
m4_define([NET], [syntax_example.owfn])
AT_CHECK([cp TESTFILES/NET .])
AT_CHECK([FIONA -s empty -t og NET], 0, ignore, ignore)
AT_CHECK([mv NET.og NET.2.og])
AT_CHECK([FIONA -t og NET], 0, ignore, ignore)
AT_CHECK([FIONA2WENDY --input=NET.og --output=NET.w.og], 0, ignore, stderr)
AT_CHECK([GREP -q "empty-node created" stderr])
AT_CHECK([WENDY2FIONA --input=NET.w.og --output=NET.f.og])
AT_CHECK([FIONA -t equivalence NET.2.og NET.f.og], 0, ignore, ignore)
AT_KEYWORDS(fiona wendy)
AT_CLEANUP

AT_SETUP([Syntax Example 2])
m4_define([NET], [syntax_example.owfn])
AT_CHECK([cp TESTFILES/NET .])
AT_CHECK([FIONA -s empty -t og NET], 0, ignore, ignore)
AT_CHECK([WENDY --og=NET.w.og NET], 0, ignore, ignore)
AT_CHECK([WENDY2FIONA --input=NET.w.og --output=NET.f.og])
AT_CHECK([FIONA -t equivalence NET.og NET.f.og], 0, ignore, ignore)
AT_KEYWORDS(fiona wendy)
AT_CLEANUP

AT_SETUP([Fiona with Empty Node])
m4_define([NET], [syntax_example.owfn])
AT_CHECK([cp TESTFILES/NET .])
AT_CHECK([FIONA -s empty -t og NET], 0, ignore, ignore)
AT_CHECK([FIONA2WENDY --input=NET.og --output=NET.w.og])
AT_CHECK([WENDY2FIONA --input=NET.w.og --output=NET.f.og])
AT_CHECK([FIONA -t equivalence NET.og NET.f.og], 0, ignore, ignore)
AT_KEYWORDS(fiona wendy)
AT_CLEANUP

AT_SETUP([Synchronous Fiona OG])
m4_define([NET], [synchronous])
AT_CHECK([cp TESTFILES/NET.fiona.og .])
AT_CHECK([FIONA2WENDY --input=NET.fiona.og --output=NET.wendy.og])
AT_CHECK([WENDY2FIONA --input=NET.wendy.og --output=NET.fiona.2.og])
AT_CHECK([FIONA -t equivalence NET.fiona.og NET.fiona.2.og], 0, ignore, ignore)
AT_KEYWORDS(fiona wendy synchronous)
AT_CLEANUP

############################################################################
AT_BANNER([Wendy: CNF OG -> Bit OG])
############################################################################

AT_SETUP([Syntax Example])
m4_define([NET], [syntax_example.owfn])
AT_CHECK([cp TESTFILES/NET .])
AT_CHECK([WENDY --og=NET.og --formula=cnf NET], 0, ignore, ignore)
AT_CHECK([WENDYFORMULA2BITS --input=NET.og --output=NET.b.og])
AT_CHECK([SAYO --input=NET.b.og --output=NET.sa])
AT_CHECK([SA2SM NET.sa NET.owfn])
AT_CHECK([WENDY --og=NET.owfn.og --fionaFormat NET.owfn], 0, ignore, ignore)
AT_CHECK([WENDY --og=NET.f.og --fionaFormat NET], 0, ignore, ignore)
AT_CHECK([FIONA -t equivalence NET.f.og NET.owfn.og], 0, ignore, ignore)
AT_KEYWORDS(wendy formula bit)
AT_CLEANUP

AT_SETUP([S-Bit])
m4_define([NET], [bit_s.owfn])
AT_CHECK([cp TESTFILES/NET .])
AT_CHECK([WENDY --og=NET.bit.og --formula=bits NET], 0, ignore, ignore)
AT_CHECK([WENDY --og=NET.cnf.og --formula=cnf NET], 0, ignore, ignore)
AT_CHECK([WENDYFORMULA2BITS --input=NET.cnf.og --output=NET.cnf.b.og], 0, ignore, ignore)
AT_CHECK([SAYO --input=NET.bit.og --output=NET.bit.sa], 0, ignore, ignore)
AT_CHECK([SAYO --input=NET.cnf.b.og --output=NET.cnf.sa], 0, ignore, ignore)
AT_CHECK([SA2SM NET.bit.sa NET.bit.owfn], 0, ignore, ignore)
AT_CHECK([SA2SM NET.cnf.sa NET.cnf.owfn], 0, ignore, ignore)
AT_CHECK([WENDY --og=NET.bit.owfn.og --fionaFormat NET.bit.owfn], 0, ignore, ignore)
AT_CHECK([WENDY --og=NET.cnf.owfn.og --fionaFormat NET.cnf.owfn], 0, ignore, ignore)
AT_CHECK([FIONA -t equivalence NET.cnf.owfn.og NET.bit.owfn.og], 0, ignore, ignore)
AT_KEYWORDS(wendy formula bit)
AT_CLEANUP


############################################################################
AT_BANNER([IG <-> SA])
############################################################################

AT_SETUP([Syntax Example])
m4_define([NET], [syntax_example.owfn])
AT_CHECK([cp TESTFILES/NET .])
AT_CHECK([FIONA -t ig NET], 0, ignore, ignore)
AT_CHECK([IG2SA --input=NET.ig.og --output=NET.sa])
AT_CHECK([SA2SM NET.sa NET.owfn])
AT_CHECK([WENDY --og=NET.og --fionaFormat NET], 0, ignore, ignore)
AT_CHECK([WENDY --og=NET.owfn.og --fionaFormat NET.owfn], 0, ignore, ignore)
AT_CHECK([FIONA -t equivalence NET.og NET.owfn.og], 0, ignore, ignore)
AT_KEYWORDS(ig sa)
AT_CLEANUP


