AT_INIT

# check if several tools were found by the configure script
m4_define(AT_CHECK_DOT, [AT_CHECK([if test "DOT" == "not found"; then exit 77; fi])])


############################################################################
AT_BANNER([Standard Options])
############################################################################

AT_SETUP([Help output])
AT_CHECK([OG2DOT --help],0,ignore)
AT_KEYWORDS(basic)
AT_CLEANUP

AT_SETUP([Version output])
AT_CHECK([OG2DOT --version],0,ignore)
AT_KEYWORDS(basic)
AT_CLEANUP

############################################################################
AT_BANNER([I/O Tests])
############################################################################

AT_SETUP([File In, File Out])
AT_CHECK([cp TESTFILES/myCoffee.wendy.og .])
AT_CHECK([OG2DOT --input=myCoffee.wendy.og --output=myCoffee.wendy.dot],0)
AT_CHECK([test -f myCoffee.wendy.dot])
AT_KEYWORDS(io)
AT_CLEANUP

AT_SETUP([File In, Pipe Out])
AT_CHECK([cp TESTFILES/myCoffee.fiona.og .])
AT_CHECK([OG2DOT --input=myCoffee.fiona.og > myCoffee.fiona.dot],0)
AT_CHECK([test -f myCoffee.fiona.dot])
AT_KEYWORDS(io)
AT_CLEANUP

AT_SETUP([Pipe In, File Out])
AT_CHECK([cp TESTFILES/myCoffee.og .])
AT_CHECK([cat myCoffee.og | OG2DOT --output=myCoffee.dot],0)
AT_CHECK([test -f myCoffee.dot])
AT_KEYWORDS(io)
AT_CLEANUP

AT_SETUP([Pipe In, Pipe Out])
AT_CHECK([cp TESTFILES/PO.fiona.og .])
AT_CHECK([cat PO.fiona.og | OG2DOT > PO.fiona.dot],0)
AT_CHECK([test -f PO.fiona.dot])
AT_KEYWORDS(io)
AT_CLEANUP

############################################################################
AT_BANNER([DOT OUTPUT TESTS])
############################################################################

AT_SETUP([Piping to dot])
AT_CHECK_DOT
AT_CHECK([cp TESTFILES/myCoffee.og .])
AT_CHECK([OG2DOT --input=myCoffee.og | dot],0,ignore)
AT_KEYWORDS(dot)
AT_CLEANUP

