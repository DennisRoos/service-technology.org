AT_INIT

# define macros to skip a test if LoLA or Fiona was not found by configure
m4_define(AT_CHECK_LOLA, [AT_CHECK([if test "LOLA_FULL" == ""; then exit 77; fi])])
m4_define(AT_CHECK_WENDY, [AT_CHECK([if test "WENDY" == ""; then exit 77; fi])])
#m4_define(AT_CHECK_FIONA, [AT_CHECK([if test "FIONA" == "not found"; then exit 77; fi])])

AT_TESTED(versions.sh)
#AT_TESTED(WENDY)
#AT_TESTED(LOLA_FULL)


############################################################################
AT_BANNER([Standard Options])
############################################################################

AT_SETUP([Help output])
AT_CHECK([MARLENE --help],0,ignore)
AT_KEYWORDS(basic)
AT_CLEANUP

AT_SETUP([Version output])
AT_CHECK([MARLENE --version],0,ignore)
AT_KEYWORDS(basic)
AT_CLEANUP

############################################################################
AT_BANNER([Small examples])
############################################################################

AT_SETUP([Small test (synchronous)])
AT_CHECK_WENDY
AT_CHECK_LOLA
AT_CHECK([cp TESTFILES/test.owfn TESTFILES/test.ar .])
AT_CHECK([MARLENE test.owfn -r test.ar],0,ignore)
AT_KEYWORDS(sample)
AT_CLEANUP

AT_SETUP([Small test (asynchronous)])
AT_CHECK_WENDY
AT_CHECK_LOLA
AT_CHECK([cp TESTFILES/test.owfn TESTFILES/test.ar .])
AT_CHECK([MARLENE test.owfn -r test.ar -a],0,ignore)
AT_KEYWORDS(sample)
AT_CLEANUP

AT_SETUP([Small test (no complement)])
AT_CHECK_WENDY
AT_CHECK_LOLA
AT_CHECK([cp TESTFILES/test-n.owfn TESTFILES/test-n.ar .])
AT_CHECK([MARLENE test-n.owfn -r test-n.ar -n],0,ignore)
AT_KEYWORDS(sample)
AT_CLEANUP

############################################################################
AT_BANNER([Special options])
############################################################################

AT_SETUP([Verbose and very verbose information])
AT_CHECK_WENDY
AT_CHECK_LOLA
AT_CHECK([cp TESTFILES/test.owfn TESTFILES/test.ar .])
AT_CHECK([MARLENE test.owfn -r test.ar -vw],0,ignore,ignore)
AT_KEYWORDS(special)
AT_CLEANUP

AT_SETUP([Bug information])
AT_CHECK([MARLENE --bug],0,,ignore)
AT_CHECK([test -f bug.log])
AT_KEYWORDS(special)
AT_CLEANUP


